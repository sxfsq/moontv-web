"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[326],{93326:function(e,t,r){r.d(t,{Z:function(){return U}});var a=r(85787),s=r(55954);function l(){return(0,a.jsx)("button",{onClick:()=>window.history.back(),className:"w-10 h-10 p-2 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-200/50 dark:text-gray-300 dark:hover:bg-gray-700/50 transition-colors","aria-label":"Back",children:(0,a.jsx)(s.Z,{className:"w-full h-full"})})}var n=r(54465),d=r(57621),o=r(42591),i=r(34680),c=r(23516),x=r(14515),g=r(57311),u=r(8838),m=r(36429),h=e=>{let{activePath:t}=e,r=(0,u.usePathname)(),s=null!=t?t:r,[l,h]=(0,m.useState)([{icon:n.Z,label:"首页",href:"/"},{icon:d.Z,label:"搜索",href:"/search"},{icon:o.Z,label:"电影",href:"/douban?type=movie"},{icon:i.Z,label:"剧集",href:"/douban?type=tv"},{icon:c.Z,label:"综艺",href:"/douban?type=show"}]);(0,m.useEffect)(()=>{var e;let t=window.RUNTIME_CONFIG;(null==t?void 0:null===(e=t.CUSTOM_CATEGORIES)||void 0===e?void 0:e.length)>0&&h(e=>[...e,{icon:x.Z,label:"自定义",href:"/douban?type=custom"}])},[]);let y=e=>{var t;let r=null===(t=e.match(/type=([^&]+)/))||void 0===t?void 0:t[1],a=decodeURIComponent(s);return a===decodeURIComponent(e)||a.startsWith("/douban")&&a.includes("type=".concat(r))};return(0,a.jsx)("nav",{className:"md:hidden fixed left-0 right-0 z-[600] bg-white/90 backdrop-blur-xl border-t border-gray-200/50 overflow-hidden dark:bg-gray-900/80 dark:border-gray-700/50",style:{bottom:0,paddingBottom:"env(safe-area-inset-bottom)",minHeight:"calc(3.5rem + env(safe-area-inset-bottom))"},children:(0,a.jsx)("ul",{className:"flex items-center overflow-x-auto scrollbar-hide",children:l.map(e=>{let t=y(e.href);return(0,a.jsx)("li",{className:"flex-shrink-0",style:{width:"20vw",minWidth:"20vw"},children:(0,a.jsxs)(g.default,{href:e.href,className:"flex flex-col items-center justify-center w-full h-14 gap-1 text-xs",children:[(0,a.jsx)(e.icon,{className:"h-6 w-6 ".concat(t?"text-green-600 dark:text-green-400":"text-gray-500 dark:text-gray-400")}),(0,a.jsx)("span",{className:t?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-300",children:e.label})]})},e.href)})})})},y=r(93555),b=r(7897),f=r(44703),p=r(42200),v=r(9303),k=r(40216),j=r(56770),N=r(90742),w=r(47505),S=r(95581),C=r(70669);let I=()=>{let e=(0,u.useRouter)(),[t,r]=(0,m.useState)(!1),[s,l]=(0,m.useState)(!1),[n,d]=(0,m.useState)(!1),[o,i]=(0,m.useState)(!1),[c,x]=(0,m.useState)(null),[g,h]=(0,m.useState)("localstorage"),[y,b]=(0,m.useState)(!1),[I,O]=(0,m.useState)(!0),[E,_]=(0,m.useState)(""),[P,T]=(0,m.useState)(""),[U,Z]=(0,m.useState)(!0),[A,R]=(0,m.useState)(!1),[F,D]=(0,m.useState)(!1),[J,z]=(0,m.useState)(""),[M,G]=(0,m.useState)(""),[B,W]=(0,m.useState)(!1),[q,H]=(0,m.useState)(""),[Y,L]=(0,m.useState)(""),[V,X]=(0,m.useState)(""),[K,Q]=(0,m.useState)(!1),[$,ee]=(0,m.useState)(""),[et,er]=(0,m.useState)(null),[ea,es]=(0,m.useState)(!0);(0,m.useEffect)(()=>{b(!0)},[]),(0,m.useEffect)(()=>{var e;x((0,S.v)()),h((null===(e=window.RUNTIME_CONFIG)||void 0===e?void 0:e.STORAGE_TYPE)||"localstorage")},[]),(0,m.useEffect)(()=>{{var e,t;let r=localStorage.getItem("defaultAggregateSearch");null!==r&&O(JSON.parse(r));let a=localStorage.getItem("enableDoubanProxy"),s=(null===(e=window.RUNTIME_CONFIG)||void 0===e?void 0:e.DOUBAN_PROXY)||"";null!==a?D(JSON.parse(a)):s&&D(!0);let l=localStorage.getItem("doubanProxyUrl");null!==l?_(l):s&&_(s);let n=localStorage.getItem("enableImageProxy"),d=(null===(t=window.RUNTIME_CONFIG)||void 0===t?void 0:t.IMAGE_PROXY)||"";null!==n?R(JSON.parse(n)):d&&R(!0);let o=localStorage.getItem("imageProxyUrl");null!==o?T(o):d&&T(d);let i=localStorage.getItem("enableOptimization");null!==i&&Z(JSON.parse(i))}},[]),(0,m.useEffect)(()=>{(async()=>{try{let e=await (0,C.Df)();er(e)}catch(e){console.warn("版本检查失败:",e)}finally{es(!1)}})()},[]);let el=async()=>{try{document.cookie="auth=; path=/; expires=".concat(new Date(0).toUTCString(),"; samesite=lax")}catch(e){}window.location.href="/"},en=()=>{i(!1),L(""),X(""),ee("")},ed=async()=>{if(ee(""),!Y){ee("新密码不得为空");return}if(Y!==V){ee("两次输入的密码不一致");return}Q(!0);try{let e=await fetch("/api/admin/password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({newPassword:Y})}),t=await e.json();if(!e.ok){ee(t.error||"修改站点密码失败");return}i(!1),await el()}catch(e){ee("网络错误，请稍后重试")}finally{Q(!1)}},eo=()=>{l(!1)},ei=e=>{O(e),localStorage.setItem("defaultAggregateSearch",JSON.stringify(e))},ec=e=>{_(e),localStorage.setItem("doubanProxyUrl",e)},ex=e=>{T(e),localStorage.setItem("imageProxyUrl",e)},eg=e=>{Z(e),localStorage.setItem("enableOptimization",JSON.stringify(e))},eu=e=>{R(e),localStorage.setItem("enableImageProxy",JSON.stringify(e))},em=e=>{D(e),localStorage.setItem("enableDoubanProxy",JSON.stringify(e))},eh=(null==c?void 0:c.role)==="owner"||(null==c?void 0:c.role)==="admin",ey=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-transparent z-[1000]",onClick:()=>{r(!1)}}),(0,a.jsxs)("div",{className:"fixed top-14 right-4 w-56 bg-white dark:bg-gray-900 rounded-lg shadow-xl z-[1001] border border-gray-200/50 dark:border-gray-700/50 overflow-hidden select-none",children:[(0,a.jsx)("div",{className:"px-3 py-2.5 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-gray-50 to-gray-100/50 dark:from-gray-800 dark:to-gray-800/50",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"当前用户"}),(0,a.jsx)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium ".concat("owner"===((null==c?void 0:c.role)||"user")?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300":"admin"===((null==c?void 0:c.role)||"user")?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300"),children:(e=>{switch(e){case"owner":return"站长";case"admin":return"管理员";case"user":return"用户";default:return""}})((null==c?void 0:c.role)||"user")})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm truncate",children:(null==c?void 0:c.username)||"default"}),(0,a.jsxs)("div",{className:"text-[10px] text-gray-400 dark:text-gray-500",children:["数据存储：","localstorage"===g?"本地":g]})]})]})}),(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsxs)("button",{onClick:()=>{r(!1),l(!0)},className:"w-full px-3 py-2 text-left flex items-center gap-2.5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-sm",children:[(0,a.jsx)(f.Z,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),(0,a.jsx)("span",{className:"font-medium",children:"设置"})]}),eh&&(0,a.jsxs)("button",{onClick:()=>{e.push("/admin")},className:"w-full px-3 py-2 text-left flex items-center gap-2.5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-sm",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),(0,a.jsx)("span",{className:"font-medium",children:"管理面板"})]}),eh&&"localstorage"!==g&&(0,a.jsxs)("button",{onClick:()=>{r(!1),i(!0),L(""),X(""),ee("")},className:"w-full px-3 py-2 text-left flex items-center gap-2.5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-sm",children:[(0,a.jsx)(v.Z,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),(0,a.jsx)("span",{className:"font-medium",children:"修改站点密码"})]}),(0,a.jsx)("div",{className:"my-1 border-t border-gray-200 dark:border-gray-700"}),(0,a.jsxs)("button",{onClick:el,className:"w-full px-3 py-2 text-left flex items-center gap-2.5 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors text-sm",children:[(0,a.jsx)(k.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"font-medium",children:"登出"})]}),(0,a.jsx)("div",{className:"my-1 border-t border-gray-200 dark:border-gray-700"}),(0,a.jsx)("button",{onClick:()=>window.open("https://github.com/senshinya/MoonTV","_blank"),className:"w-full px-3 py-2 text-center flex items-center justify-center text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors text-xs",children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsxs)("span",{className:"font-mono",children:["v",C.we]}),!ea&&et&&et!==C.qu.FETCH_FAILED&&(0,a.jsx)("div",{className:"w-2 h-2 rounded-full -translate-y-2 ".concat(et===C.qu.HAS_UPDATE?"bg-yellow-500":et===C.qu.NO_UPDATE?"bg-green-400":"")})]})})]})]})]}),eb=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[1000]",onClick:eo}),(0,a.jsxs)("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md bg-white dark:bg-gray-900 rounded-xl shadow-xl z-[1001] p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"本地设置"}),(0,a.jsx)("button",{onClick:()=>{var e,t;let r=(null===(e=window.RUNTIME_CONFIG)||void 0===e?void 0:e.IMAGE_PROXY)||"",a=(null===(t=window.RUNTIME_CONFIG)||void 0===t?void 0:t.DOUBAN_PROXY)||"";O(!0),Z(!0),_(a),D(!!a),R(!!r),T(r),localStorage.setItem("defaultAggregateSearch",JSON.stringify(!0)),localStorage.setItem("enableOptimization",JSON.stringify(!0)),localStorage.setItem("doubanProxyUrl",a),localStorage.setItem("enableDoubanProxy",JSON.stringify(!!a)),localStorage.setItem("enableImageProxy",JSON.stringify(!!r)),localStorage.setItem("imageProxyUrl",r)},className:"px-2 py-1 text-xs text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 border border-red-200 hover:border-red-300 dark:border-red-800 dark:hover:border-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:"重置为默认设置",children:"重置"})]}),(0,a.jsx)("button",{onClick:eo,className:"w-8 h-8 p-1 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":"Close",children:(0,a.jsx)(j.Z,{className:"w-full h-full"})})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"默认聚合搜索结果"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"搜索时默认按标题和年份聚合显示结果"})]}),(0,a.jsx)("label",{className:"flex items-center cursor-pointer",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:I,onChange:e=>ei(e.target.checked)}),(0,a.jsx)("div",{className:"w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500 transition-colors dark:bg-gray-600"}),(0,a.jsx)("div",{className:"absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform peer-checked:translate-x-5"})]})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"启用优选和测速"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"如出现播放器劫持问题可关闭"})]}),(0,a.jsx)("label",{className:"flex items-center cursor-pointer",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:U,onChange:e=>eg(e.target.checked)}),(0,a.jsx)("div",{className:"w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500 transition-colors dark:bg-gray-600"}),(0,a.jsx)("div",{className:"absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform peer-checked:translate-x-5"})]})})]}),(0,a.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700"}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"启用豆瓣代理"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"启用后，豆瓣数据将通过代理服务器获取"})]}),(0,a.jsx)("label",{className:"flex items-center cursor-pointer",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:F,onChange:e=>em(e.target.checked)}),(0,a.jsx)("div",{className:"w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500 transition-colors dark:bg-gray-600"}),(0,a.jsx)("div",{className:"absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform peer-checked:translate-x-5"})]})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"豆瓣代理地址"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"仅在启用豆瓣代理时生效，留空则使用服务器 API"})]}),(0,a.jsx)("input",{type:"text",className:"w-full px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors ".concat(F?"border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 text-gray-400 dark:text-gray-500 placeholder-gray-400 dark:placeholder-gray-600 cursor-not-allowed"),placeholder:"例如: https://proxy.example.com/fetch?url=",value:E,onChange:e=>ec(e.target.value),disabled:!F})]}),(0,a.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700"}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"启用图片代理"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"启用后，所有图片加载将通过代理服务器"})]}),(0,a.jsx)("label",{className:"flex items-center cursor-pointer",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:A,onChange:e=>eu(e.target.checked)}),(0,a.jsx)("div",{className:"w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500 transition-colors dark:bg-gray-600"}),(0,a.jsx)("div",{className:"absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform peer-checked:translate-x-5"})]})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"图片代理地址"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"仅在启用图片代理时生效"})]}),(0,a.jsx)("input",{type:"text",className:"w-full px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors ".concat(A?"border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 text-gray-400 dark:text-gray-500 placeholder-gray-400 dark:placeholder-gray-600 cursor-not-allowed"),placeholder:"例如: https://imageproxy.example.com/?url=",value:P,onChange:e=>ex(e.target.value),disabled:!A})]})]}),(0,a.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"这些设置保存在本地浏览器中"})})]})]});return a.Fragment,j.Z,(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>{r(!t)},className:"w-10 h-10 p-2 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-200/50 dark:text-gray-300 dark:hover:bg-gray-700/50 transition-colors","aria-label":"User Menu",children:(0,a.jsx)(N.Z,{className:"w-full h-full"})}),et===C.qu.HAS_UPDATE&&(0,a.jsx)("div",{className:"absolute top-[2px] right-[2px] w-2 h-2 bg-yellow-500 rounded-full"})]}),t&&y&&(0,w.createPortal)(ey,document.body),s&&y&&(0,w.createPortal)(eb,document.body),o&&y&&(0,w.createPortal)((0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[1000]",onClick:en}),(0,a.jsxs)("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md bg-white dark:bg-gray-900 rounded-xl shadow-xl z-[1001] p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"修改站点密码"}),(0,a.jsx)("button",{onClick:en,className:"w-8 h-8 p-1 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":"Close",children:(0,a.jsx)(j.Z,{className:"w-full h-full"})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"新密码"}),(0,a.jsx)("input",{type:"password",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400",placeholder:"请输入新密码",value:Y,onChange:e=>L(e.target.value),disabled:K})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"确认密码"}),(0,a.jsx)("input",{type:"password",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400",placeholder:"请再次输入新密码",value:V,onChange:e=>X(e.target.value),disabled:K})]}),$&&(0,a.jsx)("div",{className:"text-red-500 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-md border border-red-200 dark:border-red-800",children:$})]}),(0,a.jsxs)("div",{className:"flex gap-3 mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("button",{onClick:en,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md transition-colors",disabled:K,children:"取消"}),(0,a.jsx)("button",{onClick:ed,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-600 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:K||!Y||!V,children:K?"修改中...":"确认修改"})]}),(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"修改后需重新登录"})})]})]}),document.body)]})};var O=e=>{let{showBackButton:t=!1}=e,{siteName:r}=(0,y.W)();return(0,a.jsxs)("header",{className:"md:hidden relative w-full bg-white/70 backdrop-blur-xl border-b border-gray-200/50 shadow-sm dark:bg-gray-900/70 dark:border-gray-700/50",children:[(0,a.jsxs)("div",{className:"h-12 flex items-center justify-between px-4",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:t&&(0,a.jsx)(l,{})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b.T,{}),(0,a.jsx)(I,{})]})]}),(0,a.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:(0,a.jsx)(g.default,{href:"/",className:"text-2xl font-bold text-green-600 tracking-tight hover:opacity-80 transition-opacity",children:r})})]})},E=r(88302);let _=(0,m.createContext)({isCollapsed:!1}),P=()=>{let{siteName:e}=(0,y.W)();return(0,a.jsx)(g.default,{href:"/",className:"flex items-center justify-center h-16 select-none hover:opacity-80 transition-opacity duration-200",children:(0,a.jsx)("span",{className:"text-2xl font-bold text-green-600 tracking-tight",children:e})})};var T=e=>{let{onToggle:t,activePath:r="/"}=e,s=(0,u.useRouter)(),l=(0,u.usePathname)(),h=(0,u.useSearchParams)(),[y,b]=(0,m.useState)(()=>"boolean"==typeof window.__sidebarCollapsed&&window.__sidebarCollapsed);(0,m.useLayoutEffect)(()=>{let e=localStorage.getItem("sidebarCollapsed");if(null!==e){let t=JSON.parse(e);b(t),window.__sidebarCollapsed=t}},[]),(0,m.useLayoutEffect)(()=>{"undefined"!=typeof document&&(y?document.documentElement.dataset.sidebarCollapsed="true":delete document.documentElement.dataset.sidebarCollapsed)},[y]);let[f,p]=(0,m.useState)(r);(0,m.useEffect)(()=>{r?p(r):p((()=>{let e=h.toString();return e?"".concat(l,"?").concat(e):l})())},[r,l,h]);let v=(0,m.useCallback)(()=>{let e=!y;b(e),localStorage.setItem("sidebarCollapsed",JSON.stringify(e)),window.__sidebarCollapsed=e,null==t||t(e)},[y,t]),k=(0,m.useCallback)(()=>{s.push("/search")},[s]),[j,N]=(0,m.useState)([{icon:o.Z,label:"电影",href:"/douban?type=movie"},{icon:i.Z,label:"剧集",href:"/douban?type=tv"},{icon:c.Z,label:"综艺",href:"/douban?type=show"}]);return(0,m.useEffect)(()=>{var e;let t=window.RUNTIME_CONFIG;(null==t?void 0:null===(e=t.CUSTOM_CATEGORIES)||void 0===e?void 0:e.length)>0&&N(e=>[...e,{icon:x.Z,label:"自定义",href:"/douban?type=custom"}])},[]),(0,a.jsx)(_.Provider,{value:{isCollapsed:y},children:(0,a.jsxs)("div",{className:"hidden md:flex",children:[(0,a.jsx)("aside",{"data-sidebar":!0,className:"fixed top-0 left-0 h-screen bg-white/40 backdrop-blur-xl transition-all duration-300 border-r border-gray-200/50 z-10 shadow-lg dark:bg-gray-900/70 dark:border-gray-700/50 ".concat(y?"w-16":"w-64"),style:{backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)"},children:(0,a.jsxs)("div",{className:"flex h-full flex-col",children:[(0,a.jsxs)("div",{className:"relative h-16",children:[(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center transition-opacity duration-200 ".concat(y?"opacity-0":"opacity-100"),children:(0,a.jsx)("div",{className:"w-[calc(100%-4rem)] flex justify-center",children:!y&&(0,a.jsx)(P,{})})}),(0,a.jsx)("button",{onClick:v,className:"absolute top-1/2 -translate-y-1/2 flex items-center justify-center w-8 h-8 rounded-lg text-gray-500 hover:text-gray-700 hover:bg-gray-100/50 transition-colors duration-200 z-10 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:bg-gray-700/50 ".concat(y?"left-1/2 -translate-x-1/2":"right-2"),children:(0,a.jsx)(E.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("nav",{className:"px-2 mt-4 space-y-1",children:[(0,a.jsxs)(g.default,{href:"/",onClick:()=>p("/"),"data-active":"/"===f,className:"group flex items-center rounded-lg px-2 py-2 pl-4 text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] dark:text-gray-300 dark:hover:text-green-400 dark:data-[active=true]:bg-green-500/10 dark:data-[active=true]:text-green-400 ".concat(y?"w-full max-w-none mx-0":"mx-0"," gap-3 justify-start"),children:[(0,a.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,a.jsx)(n.Z,{className:"h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700 dark:text-gray-400 dark:group-hover:text-green-400 dark:data-[active=true]:text-green-400"})}),!y&&(0,a.jsx)("span",{className:"whitespace-nowrap transition-opacity duration-200 opacity-100",children:"首页"})]}),(0,a.jsxs)(g.default,{href:"/search",onClick:e=>{e.preventDefault(),k(),p("/search")},"data-active":"/search"===f,className:"group flex items-center rounded-lg px-2 py-2 pl-4 text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] dark:text-gray-300 dark:hover:text-green-400 dark:data-[active=true]:bg-green-500/10 dark:data-[active=true]:text-green-400 ".concat(y?"w-full max-w-none mx-0":"mx-0"," gap-3 justify-start"),children:[(0,a.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,a.jsx)(d.Z,{className:"h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700 dark:text-gray-400 dark:group-hover:text-green-400 dark:data-[active=true]:text-green-400"})}),!y&&(0,a.jsx)("span",{className:"whitespace-nowrap transition-opacity duration-200 opacity-100",children:"搜索"})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto px-2 pt-4",children:(0,a.jsx)("div",{className:"space-y-1",children:j.map(e=>{var t;let r=null===(t=e.href.match(/type=([^&]+)/))||void 0===t?void 0:t[1],s=decodeURIComponent(f),l=s===decodeURIComponent(e.href)||s.startsWith("/douban")&&s.includes("type=".concat(r)),n=e.icon;return(0,a.jsxs)(g.default,{href:e.href,onClick:()=>p(e.href),"data-active":l,className:"group flex items-center rounded-lg px-2 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 transition-colors duration-200 min-h-[40px] dark:text-gray-300 dark:hover:text-green-400 dark:data-[active=true]:bg-green-500/10 dark:data-[active=true]:text-green-400 ".concat(y?"w-full max-w-none mx-0":"mx-0"," gap-3 justify-start"),children:[(0,a.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,a.jsx)(n,{className:"h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700 dark:text-gray-400 dark:group-hover:text-green-400 dark:data-[active=true]:text-green-400"})}),!y&&(0,a.jsx)("span",{className:"whitespace-nowrap transition-opacity duration-200 opacity-100",children:e.label})]},e.label)})})})]})}),(0,a.jsx)("div",{className:"transition-all duration-300 sidebar-offset ".concat(y?"w-16":"w-64")})]})})},U=e=>{let{children:t,activePath:r="/"}=e;return(0,a.jsxs)("div",{className:"w-full min-h-screen",children:[(0,a.jsx)(O,{showBackButton:["/play"].includes(r)}),(0,a.jsxs)("div",{className:"flex md:grid md:grid-cols-[auto_1fr] w-full min-h-screen md:min-h-auto",children:[(0,a.jsx)("div",{className:"hidden md:block",children:(0,a.jsx)(T,{activePath:r})}),(0,a.jsxs)("div",{className:"relative min-w-0 flex-1 transition-all duration-300",children:[["/play"].includes(r)&&(0,a.jsx)("div",{className:"absolute top-3 left-1 z-20 hidden md:flex",children:(0,a.jsx)(l,{})}),(0,a.jsxs)("div",{className:"absolute top-2 right-4 z-20 hidden md:flex items-center gap-2",children:[(0,a.jsx)(b.T,{}),(0,a.jsx)(I,{})]}),(0,a.jsx)("main",{className:"flex-1 md:min-h-0 mb-14 md:mb-0",style:{paddingBottom:"calc(3.5rem + env(safe-area-inset-bottom))"},children:t})]})]}),(0,a.jsx)("div",{className:"md:hidden",children:(0,a.jsx)(h,{activePath:r})})]})}},93555:function(e,t,r){r.d(t,{SiteProvider:function(){return d},W:function(){return n}});var a=r(85787),s=r(36429);let l=(0,s.createContext)({siteName:"MoonTV",announcement:"本网站仅提供影视信息搜索服务，所有内容均来自第三方网站。本站不存储任何视频资源，不对任何内容的准确性、合法性、完整性负责。"}),n=()=>(0,s.useContext)(l);function d(e){let{children:t,siteName:r,announcement:s}=e;return(0,a.jsx)(l.Provider,{value:{siteName:r,announcement:s},children:t})}},7897:function(e,t,r){r.d(t,{T:function(){return o}});var a=r(85787),s=r(92656),l=r(18636),n=r(71707),d=r(36429);function o(){let[e,t]=(0,d.useState)(!1),{setTheme:r,resolvedTheme:o}=(0,n.F)(),i=e=>{let t=document.querySelector('meta[name="theme-color"]');if(t)t.setAttribute("content","dark"===e?"#0c111c":"#f9fbfe");else{let t=document.createElement("meta");t.name="theme-color",t.content="dark"===e?"#0c111c":"#f9fbfe",document.head.appendChild(t)}};return((0,d.useEffect)(()=>{t(!0),i(o)},[]),e)?(0,a.jsx)("button",{onClick:()=>{let e="dark"===o?"light":"dark";if(i(e),!document.startViewTransition){r(e);return}document.startViewTransition(()=>{r(e)})},className:"w-10 h-10 p-2 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-200/50 dark:text-gray-300 dark:hover:bg-gray-700/50 transition-colors","aria-label":"Toggle theme",children:"dark"===o?(0,a.jsx)(s.Z,{className:"w-full h-full"}):(0,a.jsx)(l.Z,{className:"w-full h-full"})}):(0,a.jsx)("div",{className:"w-10 h-10"})}},95581:function(e,t,r){r.d(t,{v:function(){return a}});function a(){try{let e=document.cookie.split(";").reduce((e,t)=>{let r=t.trim(),a=r.indexOf("=");if(a>0){let t=r.substring(0,a),s=r.substring(a+1);t&&s&&(e[t]=s)}return e},{}).auth;if(!e)return null;let t=decodeURIComponent(e);return t.includes("%")&&(t=decodeURIComponent(t)),JSON.parse(t)}catch(e){return null}}},70669:function(e,t,r){var a,s;r.d(t,{Df:function(){return n},qu:function(){return a},we:function(){return l}});let l="20250810154600";async function n(){return"no_update"}(s=a||(a={})).HAS_UPDATE="has_update",s.NO_UPDATE="no_update",s.FETCH_FAILED="fetch_failed"}}]);