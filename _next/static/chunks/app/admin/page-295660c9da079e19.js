(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{71857:function(e,a,l){Promise.resolve().then(l.bind(l,6620))},6620:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return i}});var n=l(85787),s=l(36429),o=l(93326);let t="moontv_admin_local_config";function r(){try{let e=localStorage.getItem(t);if(e)return JSON.parse(e)}catch(e){}let e=window.RUNTIME_CONFIG||{};return{siteName:e.SITE_NAME||"MoonTV",announcement:"",imageProxy:e.IMAGE_PROXY||"",doubanProxy:e.DOUBAN_PROXY||"",disableYellow:!!e.DISABLE_YELLOW_FILTER,homepagePasswordOverride:""}}function i(){let[e,a]=(0,s.useState)(null),[l,i]=(0,s.useState)(!1);(0,s.useEffect)(()=>{a(r())},[]);let d=async e=>{try{let l=await e.text(),n=JSON.parse(l);a(e=>{var a,l,s,o,t,i;let d=e||r();return{siteName:null!==(a=n.siteName)&&void 0!==a?a:d.siteName,announcement:null!==(l=n.announcement)&&void 0!==l?l:d.announcement,imageProxy:null!==(s=n.image_proxy)&&void 0!==s?s:d.imageProxy,doubanProxy:null!==(o=n.douban_proxy)&&void 0!==o?o:d.doubanProxy,disableYellow:!!(null!==(t=n.disable_yellow)&&void 0!==t?t:d.disableYellow),homepagePasswordOverride:null!==(i=n.homepage_password)&&void 0!==i?i:d.homepagePasswordOverride}})}catch(e){}};return e?(0,n.jsx)(o.Z,{activePath:"/admin",children:(0,n.jsxs)("div",{className:"max-w-3xl mx-auto px-4 py-8",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"静态配置面板"}),(0,n.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:"本页面不使用 /api/*。配置仅保存在本地浏览器；可导出 JSON 合并到 config.json 后重新构建。"}),(0,n.jsxs)("div",{className:"space-y-5",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2",children:"站点名称"}),(0,n.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e.siteName,onChange:l=>a({...e,siteName:l.target.value})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2",children:"公告"}),(0,n.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:3,value:e.announcement,onChange:l=>a({...e,announcement:l.target.value})})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2",children:"图片代理前缀"}),(0,n.jsx)("input",{className:"w-full border rounded px-3 py-2",placeholder:"https://imageproxy.example.com/?url=",value:e.imageProxy,onChange:l=>a({...e,imageProxy:l.target.value})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2",children:"豆瓣/下游代理前缀"}),(0,n.jsx)("input",{className:"w-full border rounded px-3 py-2",placeholder:"https://your-proxy.example.com/fetch?url=",value:e.doubanProxy,onChange:l=>a({...e,doubanProxy:l.target.value})})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("input",{id:"disableYellow",type:"checkbox",checked:e.disableYellow,onChange:l=>a({...e,disableYellow:l.target.checked})}),(0,n.jsx)("label",{htmlFor:"disableYellow",className:"text-sm",children:"关闭黄色过滤（本地）"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2",children:"覆盖站点密码（仅本地）"}),(0,n.jsx)("input",{className:"w-full border rounded px-3 py-2",type:"password",placeholder:"留空则使用 config.json 的密码",value:e.homepagePasswordOverride,onChange:l=>a({...e,homepagePasswordOverride:l.target.value})})]})]}),(0,n.jsxs)("div",{className:"mt-6 flex gap-3",children:[(0,n.jsx)("button",{className:"px-4 py-2 rounded bg-green-600 text-white",onClick:()=>{e&&(localStorage.setItem(t,JSON.stringify(e)),i(!0),setTimeout(()=>i(!1),1500))},children:l?"已保存":"保存到本地"}),(0,n.jsx)("button",{className:"px-4 py-2 rounded bg-gray-100",onClick:()=>{if(!e)return;let a=new Blob([JSON.stringify({siteName:e.siteName,announcement:e.announcement,image_proxy:e.imageProxy,douban_proxy:e.doubanProxy,disable_yellow:e.disableYellow,homepage_password:e.homepagePasswordOverride},null,2)],{type:"application/json"}),l=document.createElement("a");l.href=URL.createObjectURL(a),l.download="moontv-static-config.json",l.click(),URL.revokeObjectURL(l.href)},children:"导出 JSON"}),(0,n.jsxs)("label",{className:"px-4 py-2 rounded bg-gray-100 cursor-pointer",children:["导入 JSON",(0,n.jsx)("input",{className:"hidden",type:"file",accept:"application/json",onChange:e=>e.target.files&&e.target.files[0]&&d(e.target.files[0])})]})]}),(0,n.jsx)("div",{className:"mt-8 text-xs text-gray-500",children:"线上要全站生效：请把导出的 JSON 合并到仓库 `config.json`，并运行 `pnpm gen:runtime && pnpm build`。"})]})}):null}}},function(e){e.O(0,[967,326,541,29,744],function(){return e(e.s=71857)}),_N_E=e.O()}]);